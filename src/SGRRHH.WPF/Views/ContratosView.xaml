<UserControl x:Class="SGRRHH.WPF.Views.ContratosView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             mc:Ignorable="d" 
             d:DesignHeight="700" d:DesignWidth="1100"
             Background="#C0C0C0">
    
    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="../Resources/Styles/LegacyTheme.xaml"/>
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </UserControl.Resources>
    
    <Grid>
        <!-- ========== PANTALLA DE BIENVENIDA ========== -->
        <Grid Visibility="{Binding IsHomeVisible, Converter={StaticResource BoolToVisibilityConverter}}">
            <Grid.RowDefinitions>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            
            <StackPanel Grid.Row="0" VerticalAlignment="Center" HorizontalAlignment="Center" MaxWidth="500">
                <TextBlock Text="[CONTRATOS]" FontFamily="Courier New" FontSize="24" FontWeight="Bold"
                           Foreground="#000080" HorizontalAlignment="Center" Margin="0,0,0,10"/>
                <TextBlock Text="GESTION DE CONTRATOS" FontFamily="Tahoma" FontSize="14" FontWeight="Bold" 
                           Foreground="#000000" HorizontalAlignment="Center" Margin="0,0,0,5"/>
                <TextBlock Text="Seleccione una opcion:" FontFamily="Tahoma" FontSize="10" 
                           Foreground="#404040" HorizontalAlignment="Center" Margin="0,0,0,30"/>
                
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                    <!-- Opci贸n: Nuevo Contrato -->
                    <Border Background="White" BorderThickness="2" BorderBrush="#808080"
                            Padding="20,15" Margin="0,0,15,0" Cursor="Hand" Width="180">
                        <Border.InputBindings>
                            <MouseBinding MouseAction="LeftClick" Command="{Binding NuevoContratoCommand}"/>
                        </Border.InputBindings>
                        <StackPanel HorizontalAlignment="Center">
                            <Border Background="#008000" Width="50" Height="50" 
                                    HorizontalAlignment="Center" Margin="0,0,0,10">
                                <TextBlock Text="[+]" FontFamily="Courier New" FontSize="20" FontWeight="Bold"
                                           Foreground="White" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            <TextBlock Text="Nuevo Contrato" FontFamily="Tahoma" FontSize="10" FontWeight="Bold"
                                       Foreground="#000000" HorizontalAlignment="Center" Margin="0,0,0,4"/>
                            <TextBlock Text="Crear un contrato nuevo" FontFamily="Tahoma" FontSize="8"
                                       Foreground="#808080" HorizontalAlignment="Center"/>
                        </StackPanel>
                    </Border>
                    
                    <!-- Opci贸n: Ver Contratos -->
                    <Border Background="White" BorderThickness="2" BorderBrush="#808080"
                            Padding="20,15" Cursor="Hand" Width="180">
                        <Border.InputBindings>
                            <MouseBinding MouseAction="LeftClick" Command="{Binding ShowContentCommand}"/>
                        </Border.InputBindings>
                        <StackPanel HorizontalAlignment="Center">
                            <Border Background="#000080" Width="50" Height="50" 
                                    HorizontalAlignment="Center" Margin="0,0,0,10">
                                <TextBlock Text="[=]" FontFamily="Courier New" FontSize="20" FontWeight="Bold"
                                           Foreground="White" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            <TextBlock Text="Ver Contratos" FontFamily="Tahoma" FontSize="10" FontWeight="Bold"
                                       Foreground="#000000" HorizontalAlignment="Center" Margin="0,0,0,4"/>
                            <TextBlock Text="Gestionar existentes" FontFamily="Tahoma" FontSize="8"
                                       Foreground="#808080" HorizontalAlignment="Center"/>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </StackPanel>
            
            <Border Grid.Row="1" Background="#E0E0E0" Padding="10,8" BorderThickness="0,1,0,0" BorderBrush="#808080">
                <TextBlock Text="{Binding CurrentDateText}" HorizontalAlignment="Center" 
                           FontFamily="Tahoma" FontSize="9" Foreground="#404040"/>
            </Border>
        </Grid>
        
        <!-- ========== CONTENIDO PRINCIPAL ========== -->
        <Grid Visibility="{Binding IsContentVisible, Converter={StaticResource BoolToVisibilityConverter}}">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            
            <!-- Header -->
            <Border Grid.Row="0" Background="#000080" Padding="10,8">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    
                    <Button Grid.Column="0" Content="&lt;- Volver" 
                            Command="{Binding ShowHomeCommand}"
                            Style="{StaticResource LegacyButtonStyle}"
                            FontFamily="Tahoma" FontSize="9" Padding="10,3" Margin="0,0,15,0"/>
                    
                    <TextBlock Grid.Column="1" Text="[CONTRATOS] GESTION DE CONTRATOS" 
                               FontFamily="Courier New" FontSize="12" FontWeight="Bold" 
                               Foreground="White" VerticalAlignment="Center"/>
                </Grid>
            </Border>
            
            <!-- Alertas -->
            <Border Grid.Row="1" Background="#FFFFCC" BorderThickness="1" BorderBrush="#CC6600" 
                    Padding="8" Margin="8,8,8,0"
                    Visibility="{Binding ContratosProximosAVencer.Count, Converter={StaticResource ZeroToVisibilityConverter}}">
                <StackPanel>
                    <TextBlock Text="[!] CONTRATOS PROXIMOS A VENCER (30 dias)" 
                               FontFamily="Tahoma" FontSize="9" FontWeight="Bold" Foreground="#CC6600"/>
                    <ItemsControl ItemsSource="{Binding ContratosProximosAVencer}" Margin="0,5,0,0">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border Background="#FFE0B0" BorderThickness="1" BorderBrush="#808080" Padding="6" Margin="0,0,0,3">
                                    <TextBlock FontFamily="Tahoma" FontSize="9">
                                        <Run Text="{Binding Empleado.NombreCompleto}" FontWeight="Bold"/>
                                        <Run Text=" - Vence: "/>
                                        <Run Text="{Binding FechaFin, StringFormat=dd/MM/yyyy}"/>
                                        <Run Text=" ("/>
                                        <Run Text="{Binding TipoContrato}"/>
                                        <Run Text=")"/>
                                    </TextBlock>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </StackPanel>
            </Border>
        
            <Grid Grid.Row="2" Margin="8">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="280"/>
                    <ColumnDefinition Width="8"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                
                <!-- Panel izquierdo -->
                <Grid Grid.Column="0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <!-- Selecci贸n de empleado -->
                    <Border Grid.Row="0" BorderThickness="1" BorderBrush="#808080" Background="White">
                        <StackPanel>
                            <Border Background="#000080" Padding="6,4">
                                <TextBlock Text="SELECCIONAR EMPLEADO" FontFamily="Tahoma" FontSize="9" 
                                           FontWeight="Bold" Foreground="White"/>
                            </Border>
                            <Border Padding="8">
                                <ComboBox ItemsSource="{Binding Empleados}"
                                          SelectedItem="{Binding SelectedEmpleado}"
                                          DisplayMemberPath="NombreCompleto"
                                          FontFamily="Tahoma" FontSize="9" Height="22"/>
                            </Border>
                        </StackPanel>
                    </Border>
                    
                    <!-- Contrato activo -->
                    <Border Grid.Row="1" BorderThickness="1" BorderBrush="#808080" Background="White" Margin="0,8,0,0"
                            Visibility="{Binding ContratoActivo, Converter={StaticResource NullToVisibilityConverter}}">
                        <StackPanel>
                            <Border Background="#000080" Padding="6,4">
                                <TextBlock Text="CONTRATO ACTIVO" FontFamily="Tahoma" FontSize="9" 
                                           FontWeight="Bold" Foreground="White"/>
                            </Border>
                            <Grid Margin="8">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                
                                <StackPanel Grid.Row="0" Grid.Column="0" Margin="0,0,5,8">
                                    <TextBlock Text="Tipo:" FontFamily="Tahoma" FontSize="8" Foreground="#808080"/>
                                    <TextBlock Text="{Binding ContratoActivo.TipoContrato}" FontFamily="Tahoma" FontSize="9" FontWeight="Bold"/>
                                </StackPanel>
                                
                                <StackPanel Grid.Row="0" Grid.Column="1" Margin="0,0,0,8">
                                    <TextBlock Text="Cargo:" FontFamily="Tahoma" FontSize="8" Foreground="#808080"/>
                                    <TextBlock Text="{Binding ContratoActivo.Cargo.Nombre}" FontFamily="Tahoma" FontSize="9" FontWeight="Bold"/>
                                </StackPanel>
                                
                                <StackPanel Grid.Row="1" Grid.Column="0" Margin="0,0,5,8">
                                    <TextBlock Text="Inicio:" FontFamily="Tahoma" FontSize="8" Foreground="#808080"/>
                                    <TextBlock Text="{Binding ContratoActivo.FechaInicio, StringFormat=dd/MM/yyyy}" FontFamily="Tahoma" FontSize="9"/>
                                </StackPanel>
                                
                                <StackPanel Grid.Row="1" Grid.Column="1" Margin="0,0,0,8">
                                    <TextBlock Text="Fin:" FontFamily="Tahoma" FontSize="8" Foreground="#808080"/>
                                    <TextBlock FontFamily="Tahoma" FontSize="9">
                                        <TextBlock.Text>
                                            <Binding Path="ContratoActivo.FechaFin" StringFormat="dd/MM/yyyy" FallbackValue="Indefinido"/>
                                        </TextBlock.Text>
                                    </TextBlock>
                                </StackPanel>
                                
                                <StackPanel Grid.Row="2" Grid.ColumnSpan="2" Margin="0,0,0,8">
                                    <TextBlock Text="Salario:" FontFamily="Tahoma" FontSize="8" Foreground="#808080"/>
                                    <TextBlock Text="{Binding ContratoActivo.Salario, StringFormat=C0}" 
                                               FontFamily="Courier New" FontSize="14" FontWeight="Bold" Foreground="#008000"/>
                                </StackPanel>
                                
                                <Border Grid.Row="3" Grid.ColumnSpan="2" Background="#E0E0FF" BorderThickness="1" 
                                        BorderBrush="#808080" Padding="8" Margin="0,0,0,8">
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                        <TextBlock Text="Dias restantes: " FontFamily="Tahoma" FontSize="9" VerticalAlignment="Center"/>
                                        <TextBlock Text="{Binding DiasRestantesContrato}" 
                                                   FontFamily="Courier New" FontSize="14" FontWeight="Bold" 
                                                   Foreground="#000080" VerticalAlignment="Center"/>
                                    </StackPanel>
                                </Border>
                                
                                <Button Grid.Row="4" Grid.ColumnSpan="2" Content="Ver Contrato Firmado" 
                                        Command="{Binding VerArchivoContratoCommand}"
                                        Style="{StaticResource LegacyButtonStyle}"
                                        FontFamily="Tahoma" FontSize="9" Padding="8,4"
                                        Visibility="{Binding ContratoActivo.ArchivoAdjuntoPath, Converter={StaticResource NullToVisibilityConverter}}"/>
                            </Grid>
                        </StackPanel>
                    </Border>
                    
                    <!-- Botones de acci贸n -->
                    <Border Grid.Row="2" BorderThickness="1" BorderBrush="#808080" Background="White" 
                            Margin="0,8,0,0" VerticalAlignment="Top">
                        <StackPanel>
                            <Border Background="#000080" Padding="6,4">
                                <TextBlock Text="ACCIONES" FontFamily="Tahoma" FontSize="9" 
                                           FontWeight="Bold" Foreground="White"/>
                            </Border>
                            <StackPanel Margin="8">
                                <Button Content="Nuevo Contrato" Command="{Binding NuevoContratoCommand}"
                                        Style="{StaticResource LegacyButtonStyle}"
                                        FontFamily="Tahoma" FontSize="9" Padding="8,4" Margin="0,0,0,5" HorizontalAlignment="Stretch"/>
                                <Button Content="Editar Seleccionado" Command="{Binding EditarContratoCommand}"
                                        Style="{StaticResource LegacyButtonStyle}"
                                        FontFamily="Tahoma" FontSize="9" Padding="8,4" Margin="0,0,0,5" HorizontalAlignment="Stretch"/>
                                <Button Content="Renovar Contrato" Command="{Binding RenovarContratoCommand}"
                                        Style="{StaticResource LegacyButtonStyle}"
                                        FontFamily="Tahoma" FontSize="9" Padding="8,4" Margin="0,0,0,5" HorizontalAlignment="Stretch"/>
                                <Button Content="Finalizar Contrato" Command="{Binding FinalizarContratoCommand}"
                                        Style="{StaticResource LegacyButtonStyle}"
                                        FontFamily="Tahoma" FontSize="9" Padding="8,4" Margin="0,0,0,5" HorizontalAlignment="Stretch"/>
                                <Button Content="Eliminar" Command="{Binding EliminarContratoCommand}"
                                        Style="{StaticResource LegacyButtonStyle}"
                                        FontFamily="Tahoma" FontSize="9" Padding="8,4" HorizontalAlignment="Stretch"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>
                </Grid>
                
                <!-- Panel derecho -->
                <Grid Grid.Column="2">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <!-- Historial de contratos -->
                    <Border Grid.Row="0" BorderThickness="1" BorderBrush="#808080" Background="White">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            
                            <Border Grid.Row="0" Background="#000080" Padding="6,4">
                                <TextBlock Text="HISTORIAL DE CONTRATOS" FontFamily="Tahoma" FontSize="9" 
                                           FontWeight="Bold" Foreground="White"/>
                            </Border>
                            
                            <DataGrid Grid.Row="1" 
                                      ItemsSource="{Binding Contratos}"
                                      SelectedItem="{Binding SelectedContrato}"
                                      AutoGenerateColumns="False"
                                      IsReadOnly="True"
                                      SelectionMode="Single"
                                      GridLinesVisibility="All"
                                      HeadersVisibility="Column"
                                      BorderThickness="0"
                                      Background="White"
                                      RowBackground="White"
                                      AlternatingRowBackground="#E8E8E8"
                                      FontFamily="Tahoma" FontSize="9"
                                      ColumnHeaderHeight="22"
                                      RowHeight="20">
                                <DataGrid.ColumnHeaderStyle>
                                    <Style TargetType="DataGridColumnHeader">
                                        <Setter Property="Background" Value="#C0C0C0"/>
                                        <Setter Property="Foreground" Value="#000080"/>
                                        <Setter Property="FontWeight" Value="Bold"/>
                                        <Setter Property="FontFamily" Value="Tahoma"/>
                                        <Setter Property="FontSize" Value="9"/>
                                        <Setter Property="Padding" Value="4,2"/>
                                        <Setter Property="BorderBrush" Value="#808080"/>
                                        <Setter Property="BorderThickness" Value="0,0,1,1"/>
                                    </Style>
                                </DataGrid.ColumnHeaderStyle>
                                <DataGrid.CellStyle>
                                    <Style TargetType="DataGridCell">
                                        <Setter Property="Padding" Value="4,2"/>
                                        <Setter Property="BorderThickness" Value="0"/>
                                        <Style.Triggers>
                                            <Trigger Property="IsSelected" Value="True">
                                                <Setter Property="Background" Value="#000080"/>
                                                <Setter Property="Foreground" Value="White"/>
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </DataGrid.CellStyle>
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Tipo" Binding="{Binding TipoContrato}" Width="90"/>
                                    <DataGridTextColumn Header="Cargo" Binding="{Binding Cargo.Nombre}" Width="120"/>
                                    <DataGridTextColumn Header="Inicio" Binding="{Binding FechaInicio, StringFormat=dd/MM/yyyy}" Width="75"/>
                                    <DataGridTextColumn Header="Fin" Binding="{Binding FechaFin, StringFormat=dd/MM/yyyy}" Width="75"/>
                                    <DataGridTextColumn Header="Salario" Binding="{Binding Salario, StringFormat=C0}" Width="90"/>
                                    <DataGridTemplateColumn Header="Estado" Width="70">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding Estado}" FontFamily="Tahoma" FontSize="9">
                                                    <TextBlock.Style>
                                                        <Style TargetType="TextBlock">
                                                            <Setter Property="Foreground" Value="#000000"/>
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding Estado}" Value="Activo">
                                                                    <Setter Property="Foreground" Value="#008000"/>
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Binding Estado}" Value="Finalizado">
                                                                    <Setter Property="Foreground" Value="#CC0000"/>
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Binding Estado}" Value="Renovado">
                                                                    <Setter Property="Foreground" Value="#000080"/>
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </TextBlock.Style>
                                                </TextBlock>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                    <DataGridTemplateColumn Header="Adj" Width="35">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <Button Content="*" 
                                                        Command="{Binding DataContext.VerArchivoContratoCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                        Visibility="{Binding ArchivoAdjuntoPath, Converter={StaticResource NullToVisibilityConverter}}"
                                                        Style="{StaticResource LegacyButtonStyle}"
                                                        FontFamily="Courier New" FontSize="8" Padding="2,1"
                                                        ToolTip="Ver contrato firmado"/>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                    <DataGridTextColumn Header="Observaciones" Binding="{Binding Observaciones}" Width="*"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </Border>
                    
                    <!-- Formulario de contrato -->
                    <Border Grid.Row="1" BorderThickness="1" BorderBrush="#808080" Background="White" Margin="0,8,0,0"
                            Visibility="{Binding IsFormVisible, Converter={StaticResource BoolToVisibilityConverter}}">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <Border Grid.Row="0" Background="#000080" Padding="6,4">
                                <TextBlock FontFamily="Tahoma" FontSize="9" FontWeight="Bold" Foreground="White">
                                    <TextBlock.Style>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="Text" Value="[+] NUEVO CONTRATO"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding IsEditing}" Value="True">
                                                    <Setter Property="Text" Value="[Ed] EDITAR CONTRATO"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBlock.Style>
                                </TextBlock>
                            </Border>
                            
                            <Grid Grid.Row="1" Margin="10">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                
                                <StackPanel Grid.Row="0" Grid.Column="0" Margin="0,0,8,8">
                                    <TextBlock Text="Tipo Contrato *" FontFamily="Tahoma" FontSize="8" Foreground="#404040" Margin="0,0,0,3"/>
                                    <ComboBox ItemsSource="{Binding TiposContrato}" SelectedItem="{Binding FormTipoContrato}"
                                              FontFamily="Tahoma" FontSize="9" Height="22"/>
                                </StackPanel>
                                
                                <StackPanel Grid.Row="0" Grid.Column="1" Margin="0,0,8,8">
                                    <TextBlock Text="Fecha Inicio *" FontFamily="Tahoma" FontSize="8" Foreground="#404040" Margin="0,0,0,3"/>
                                    <DatePicker SelectedDate="{Binding FormFechaInicio}" FontFamily="Tahoma" FontSize="9" Height="22"/>
                                </StackPanel>
                                
                                <StackPanel Grid.Row="0" Grid.Column="2" Margin="0,0,8,8">
                                    <TextBlock Text="Fecha Fin" FontFamily="Tahoma" FontSize="8" Foreground="#404040" Margin="0,0,0,3"/>
                                    <DatePicker SelectedDate="{Binding FormFechaFin}" FontFamily="Tahoma" FontSize="9" Height="22"/>
                                </StackPanel>
                                
                                <StackPanel Grid.Row="0" Grid.Column="3" Margin="0,0,0,8">
                                    <TextBlock Text="Salario *" FontFamily="Tahoma" FontSize="8" Foreground="#404040" Margin="0,0,0,3"/>
                                    <TextBox Text="{Binding FormSalario, UpdateSourceTrigger=PropertyChanged, StringFormat=N0}"
                                             Style="{StaticResource LegacyTextBoxStyle}" FontFamily="Tahoma" FontSize="9" Height="22"/>
                                </StackPanel>
                                
                                <StackPanel Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2" Margin="0,0,8,8">
                                    <TextBlock Text="Cargo *" FontFamily="Tahoma" FontSize="8" Foreground="#404040" Margin="0,0,0,3"/>
                                    <ComboBox ItemsSource="{Binding Cargos}" SelectedItem="{Binding FormCargo}" 
                                              DisplayMemberPath="Nombre" FontFamily="Tahoma" FontSize="9" Height="22"/>
                                </StackPanel>
                                
                                <StackPanel Grid.Row="1" Grid.Column="2" Grid.ColumnSpan="2" Margin="0,0,0,8">
                                    <TextBlock Text="Observaciones" FontFamily="Tahoma" FontSize="8" Foreground="#404040" Margin="0,0,0,3"/>
                                    <TextBox Text="{Binding FormObservaciones, UpdateSourceTrigger=PropertyChanged}"
                                             Style="{StaticResource LegacyTextBoxStyle}" FontFamily="Tahoma" FontSize="9" Height="22"/>
                                </StackPanel>
                                
                                <StackPanel Grid.Row="2" Grid.ColumnSpan="4" Margin="0,0,0,8">
                                    <TextBlock Text="Contrato Firmado (PDF):" FontFamily="Tahoma" FontSize="8" Foreground="#404040" Margin="0,0,0,3"/>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox Grid.Column="0" Text="{Binding FormArchivoAdjuntoPath, Mode=OneWay}" 
                                                 IsReadOnly="True" Style="{StaticResource LegacyTextBoxStyle}"
                                                 Background="#E0E0E0" FontFamily="Tahoma" FontSize="9" Height="22"/>
                                        <Button Grid.Column="1" Content="..." Command="{Binding SeleccionarArchivoCommand}"
                                                Style="{StaticResource LegacyButtonStyle}"
                                                Width="25" Height="22" Margin="3,0,0,0" FontFamily="Tahoma" FontSize="9"/>
                                        <Button Grid.Column="2" Content="X" Command="{Binding EliminarArchivoCommand}"
                                                Style="{StaticResource LegacyButtonStyle}"
                                                Width="22" Height="22" Margin="3,0,0,0" FontFamily="Tahoma" FontSize="9"
                                                Visibility="{Binding FormArchivoAdjuntoPath, Converter={StaticResource NullToVisibilityConverter}}"/>
                                    </Grid>
                                </StackPanel>
                                
                                <StackPanel Grid.Row="3" Grid.ColumnSpan="4" Orientation="Horizontal" HorizontalAlignment="Right">
                                    <Button Content="Cancelar" Command="{Binding CancelarFormularioCommand}"
                                            Style="{StaticResource LegacyButtonStyle}"
                                            FontFamily="Tahoma" FontSize="9" Padding="12,4" Margin="0,0,8,0"/>
                                    <Button Content="Guardar" Command="{Binding GuardarContratoCommand}"
                                            Style="{StaticResource LegacyButtonStyle}"
                                            FontFamily="Tahoma" FontSize="9" FontWeight="Bold" Padding="12,4"/>
                                </StackPanel>
                            </Grid>
                        </Grid>
                    </Border>
                </Grid>
            </Grid>
        </Grid>
        
        <!-- Loading overlay -->
        <Grid Background="#80000000" 
              Visibility="{Binding IsLoading, Converter={StaticResource BoolToVisibilityConverter}}">
            <Border Background="#C0C0C0" BorderThickness="2" BorderBrush="#808080" Padding="25" 
                    HorizontalAlignment="Center" VerticalAlignment="Center">
                <StackPanel>
                    <TextBlock Text="[...] Cargando" FontFamily="Courier New" FontSize="12" FontWeight="Bold"
                               HorizontalAlignment="Center" Margin="0,0,0,10"/>
                    <ProgressBar IsIndeterminate="True" Width="150" Height="18"/>
                    <TextBlock Text="Por favor espere..." FontFamily="Tahoma" FontSize="9"
                               HorizontalAlignment="Center" Foreground="#404040" Margin="0,10,0,0"/>
                </StackPanel>
            </Border>
        </Grid>
    </Grid>
</UserControl>
